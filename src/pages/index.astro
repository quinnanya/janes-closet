---
import Head from "../components/Head.astro";
import Loader from "../components/Loader.astro";
import StyledSelect from "../components/StyledSelect.astro";
import Icon from "../components/Icon.astro";
import { memes, memeTypes } from "../dataset.mjs";

import styles from "../styles/styles.css";
import suchoLogo from "../img/sucho-logo.32x32.png";

const title = "SUCHO Meme Wall";
const description =
  "Collected memes from the SUCHO project concerning the Russian invasion of Ukraine.";
---

<html lang="en">
  <Head {title} {description} />
  <body>
    <header>
      <h1>
        <img src={suchoLogo} alt="SUCHO" />
        <a href={Astro.site.pathname} title="SUCHO Meme Wall"
          >SUCHO Meme Wall
        </a>
      </h1>
      <div class="controls">
        <span class="count">{memes.length} / {memes.length}</span>
        <StyledSelect title="Filter Memes">
          <option value="" disabled selected>-- Filter by Meme Type --</option>
          {Array.from(memeTypes).map((memeType) => (
            <option value={memeType} set:text={
              `${memeType} [${memes.filter((meme) => meme.memeTypes.includes(memeType)).length}]`}>
            </option>
          ))}
        </StyledSelect>
        <div class="search">
          <button class="search" title="Search Memes"
            ><Icon name="search" />
          </button>
          <input id="search-input" type="text" />
          <label for="search-input" class="visually-hidden">Search Term</label>
        </div>
        <button class="shuffle" title="Shuffle Memes"
          ><Icon name="shuffle" />
        </button>
      </div>
    </header>
    <main id="meme-wall" class="loading">
      {memes.map((meme, idx) => (
        <article data-types={meme.memeTypes.join("|")}>
          {idx < 20 ? (
            <img
              src={Astro.site.pathname + meme.mediaPath}
              style={`aspect-ratio: ${meme.aspectRatio};background-image: url(${meme.thumbnail})`}
              alt={meme.title}
            />
          ) : (
            <img
              data-src={Astro.site.pathname + meme.mediaPath}
              style={`aspect-ratio: ${meme.aspectRatio};background-image: url(${meme.thumbnail})`}
              alt={meme.title}
            />
          )}

          <section>
            <dl>
              <dt>Title:</dt>
              <dd>{meme.title}</dd>
              <dt>Translation:</dt>
              <dd>{meme.textTranslatedIntoEnglish}</dd>
            </dl>
          </section>
        </article>
      ))}
    </main>
    <Loader />
    <script type="module" hoist>
      import "../js/script.js";
    </script>
  </body>
</html>
